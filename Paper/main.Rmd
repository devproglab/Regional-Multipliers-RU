---
title: "Неоднородность влияния бюджетной политики на регионы России^[Контактная информация: Гуленков И. В., igulenkov@hse.ru] ^,^ ^[Исследование осуществлено в рамках Программы фундаментальных исследований НИУ ВШЭ в 2025 г.]"
author: '**И. В. Гуленков.** Департамент теоретической экономики, Международная лаборатория макроэкономического анализа, Национальный исследовательский университет "Высшая школа экономики", Москва'
abstract: |
    В работе рассматривается влияние расходов региональных бюджетов на экономическую активность в российских регионах. На ежемесячных данных за период с 2009 по 2024 год для 79 регионов оценивается региональный фискальный мультипликатор - процентное изменение индекса деловой активности в ответ на шок бюджетных расходов, эквивалентный 1% подушевого ВРП региона. Медианная величина регионального мультипликатора достигает пика через 2 месяца после шока и составляет 1.09%. Более сильный отклик наблюдается в регионах с более высоким подушевым ВРП, высоким уровнем неравенства по доходам и преобладанием крупных предприятий в структуре занятости. Региональные бюджетные шоки также отражаются на экономике регионов-соседей значимыми спилловер-эффектами (эффектами перелива), величина которых зависит от размера экономики региона-источника шока и его внешнеторговых связей. Результаты исследования подтверждают влияние гетерогенности домохозяйств, фирм и регионов на трансмиссию фискальных шоков, а также демонстрируют, что наращивание расходов в экономически более развитых регионах может выступать фактором усиления межрегионального неравенства.
    
    Ключевые слова: фискальный мультипликатор, региональный бюджет, фискальная политика, региональная неоднородность, пространственные эффекты
    
    JEL: E62, H72, C33
    
    The paper estimates the impact of regional budget expenditures on economic activity in Russian regions. Using monthly data over 2009 - 2024 for 79 regions we estimate region-specific multipliers defined as a percentage change in the output index after a budget stimulus equivalent to 1% of per capita gross regional product (GRP). The median regional multiplier peaks 2 months after the shock and equals 1.09%. A stronger response of output is observed in regions with higher per capita GRP, income inequality and employment concentrated in large enterprises. Regional spending shocks also affect neighbouring regions through spillover effects. Their strength depends on the size of the source region and its trade linkages. Our results confirm that household-, firm- and region-level heterogeneity affects macroeconomic outcomes. We also argue that active spending policy in more developed regions might be a factor of increasing interregional inequality.
    
    Keywords: fiscal multiplier, regional budget, fiscal policy, regional heterogeneity, spatial effects
    
    JEL: E62, H72, C33
lang: ru
output: 
  # bookdown::pdf_document2
  officedown::rdocx_document:
    base_format: "bookdown::word_document2"
    reference_docx: "../Technical/template.docx"
    pandoc_args: [ "--csl", "../Technical/apa-no-ampersand.csl"]
    global_numbering: true
    plots:
      caption:
        pre: "Рисунок "
        sep: ". "
      topcaption: true
    tables:
      caption:
        style: Table Caption
        pre: "Таблица "
        sep: ". "
  # bookdown::html_document2:
  #   pandoc_args: [ "--csl", "../Technical/apa-no-ampersand.csl"]
  #   global_numbering: true
header-includes:
  - \usepackage{tikz} 
  - \usepackage[T2A]{fontenc}
  - \usepackage[main=russian,english]{babel}
bibliography: ../Literature/RFS.bib
biblio-style: apalike
---

\newcommand*\vect[1]{\mathbf{#1}}

```{r Setup, echo = F, include = FALSE}
opts <- list(template = "../Technical/tikz2pdf-cyr.tex")
engine <- 'tikz'
knitr::opts_chunk$set(echo = F, message = F, warning = F)
trace(grDevices:::png, quote({
  if (missing(type) && missing(antialias)) {
    type <- "cairo-png"
    antialias <- "subpixel"
  }
}), print = FALSE)
```

```{r Data, echo = F}
set.seed(123)
library(tidyverse)
library(readxl)
library(ggtext)
library(geofacet)
library(scales)
library(ggpattern)
library(ggridges)
library(ggbreak) 
library(spatstat)
library(sandwich)
library(lmtest)
library(kableExtra)
library(ggcorrplot)
library(cluster)    # clustering algorithms
library(flextable)
library(huxtable)
options(scipen=9999)
set_flextable_defaults(font.family = 'Times New Roman')
tabForm <- function(x, cap) {
  x %>%
  autofit() %>%
  set_table_properties(layout = "autofit") %>%
  flextable::font(fontname = 'Times New Roman', part = 'all') %>%
  padding(padding = 0, part = "all") %>%
  flextable::align(align = "center", part = "all") %>%
  flextable::align(align = 'justify', part = 'footer') %>%
  colformat_double(big.mark = ",", digits = 2, na_str = "N/A") %>%
  flextable::set_caption(cap, align_with_table = F, word_stylename = "Table Caption", fp_p = officer::fp_par(text.align = "justify"))
}
figNote <- function(text) {
  officer::fpar(paste0('Примечание: ', text), fp_p=officer::fp_par(text.align = 'justify', padding.top = 0), fp_t = officer::fp_text_lite(font.size = 11))
}
# LOAD STYLING ----
source("../Technical/hse_theme.R")
select <- dplyr::select
hse_colours <- c("#102D69", "#1656A6", "#BFBFBF", "#E61F3D", "#11A0D7", "#FFD746", "#029C63", "#EB681F")
# LOAD DATA ----
QUANTILES <- c(0.15, 0.5, 0.85)
SIG_OPACITY <- 0.75
GRADIENT_QUANTILE_LIMITS <- c(0.15,0.85)
source('../R/3. mult.R')
```

# Введение {-}

Выраженная социально-экономическая дифференциация российских регионов является предпосылкой для различного влияния мер бюджетной политики на их экономику. Если эти различия достаточно существенны, то перераспределение государственных расходов в пространстве может существенно повлиять не только на экономику отдельных регионов, но и на макроэкономическую динамику в рамках всей страны. С точки зрения проведения контрциклической политики, наиболее результативной была бы концентрация бюджетных расходов в регионах, где эти расходы оказывают максимальное влияние на выпуск. Однако инструменты фискальной политики, особенно в России, используется не только для сглаживания делового цикла, но и для выравнивания региональных диспропорций. В этом случае распределение средств между регионами становится не столь очевидным. С одной стороны, ставка на экономически развитые регионы с выраженными конкурентными преимуществами может стимулировать развитие остальных регионов за счёт положительных пространственных эффектов [@zubarevichNeravenstvoRegionovKrupnyh2019]. С другой стороны, наращивание бюджетных расходов в менее развитых регионах напрямую может позволить сильнее снизить межрегиональное неравенство. Таким образом, для повышения эффективности перераспределения ресурсов с помощью бюджетного процесса необходимо детальное понимание того, какие эффекты оказывает фискальная политика на отдельные регионы страны.

Влияние фискальной политики на экономическую активность чаще всего описывается с помощью мультипликатора - величины, определяющей изменение совокупного выпуска в ответ на единичное изменение государственных расходов. В обзоре эмпирических работ, посвящённых США, @rameyCanGovernmentPurchases2011 заключает, что величина мультипликатора на национальном уровне лежит между 0.8 и 1.5. При этом отмечается широкий разброс оценок в зависимости от периода, инструмента политики и персистентности шока госрасходов. Более поздние эмпирические работы демонстрируют, что мультипликатор может зависеть от фазы делового цикла и природы шоков, с которыми сталкивается экономика [@auerbachFiscalMultipliersRecession2011; @ghassibeStateDependenceFiscal2022]. Современные структурные модели показывают, что неравенство по доходам является важным фактором, определяющим силу эффектов фискальной политики [@cantoreWorkersCapitalistsGovernment2021;@auclertMPCsMPEsMultipliers2023; @broerFiscalMultipliersHeterogeneousagent2023]. Существующие оценки мультипликатора бюджетных расходов для России разнятся от 0.1 до 0.9. При этом отмечается их неоднородность в зависимости от типа бюджетных расходов и периода оценки [@zyablickiyOcenkaFiskalnyhMultiplikatorov2020].

Распространение дезагрегированных данных об экономической активности на субнациональном уровне сделало возможным оценку так называемых *локальных мультипликаторов*. Полученные с использованием гранулярных региональных данных и нестандартных схем идентификации, локальные мультипликаторы характеризуют разницу в динамике выпуска между регионом, в котором произошёл рост государственных расходов, по сравнению с другими регионами [@nakamuraFiscalStimulusMonetary2014;@chodorow-reichGeographicCrossSectionalFiscal2019]. Применение моделей, учитывающих кросс-секциональную вариацию, улучшает статистические свойства оценок мультипликаторов, а также позволяет проконтролировать влияние факторов, действующих на все регионы одновременно. К ним относятся общие для всей экономики шоки или макроэкономическая политика на национальном уровне. 

Обширная литература о локальных мультипликаторах свидетельствует, помимо прочего, что региональные бюджетные шоки отражаются на экономике регионов-соседей значимыми спилловер-эффектами (эффектами перелива). Положительные эффекты перелива распространяются как через отрасли, напрямую связанные с бюджетополучателем цепочками поставок, так и через классический кейнсианский канал, стимулируя рост доходов жителей региона и их потребительские расходы.  @auerbachLocalFiscalMultipliers2020 отмечают, что все типы спилловер-эффектов, включая канал совокупного спроса, являются значимыми и положительными. Таким образом, оценка региональных мультипликаторов в отрыве от пространственных эффектов приводит к систематическому занижению их величины. Существование выраженных, но неоднородных спилловер-эффектов между регионами России также хорошо документировано в литературе [@demidovaGosudarstvennyeRashodyNa2021]. Так, например, более чувствительными к пространственным экстерналиям оказываются высокоурбанизированные регионы [@demidovaModeliEkonomicheskogoRosta2016].

Настоящее исследование призвано оценить величину фискальных мультипликатора государственных расходов на уровне отдельных регионов России с учётом возникающих пространственных эффектов. В нём впервые для анализа воздействия мер фискальной политики в российской экономике использована модель глобальной векторной авторегрессии (GVAR), которая позволяет учитывать возникающие спилловер-эффекты благодаря наличию межрегиональных взаимосвязей. Модель оценивается с помощью байесовских методов на месячных данных за период 2009 - 2024 гг. и включает данные о деловой активности, инфляции и исполнению бюджетов на уровне субъектов РФ, а также общероссийские переменные. 
Настоящая работа вносит вклад в несколько направлений литературы. 

Во-первых, получены оценки фискального мультипликатора за период 2009 - 2024 гг. для каждого региона России в отдельности, в то время как существующие работы оценивают его только на национальном уровне [@zyablickiyOcenkaFiskalnyhMultiplikatorov2020, прил. 1]. Пиковый медианный отклик региональной деловой активности на шок госрасходов, эквивалентный 1% ВРП, наблюдается через `r YMaxHor` месяца после шока и достигает `r YMax`%. Более сильный мультипликативный эффект наблюдается в более богатых регионах с высоким уровнем неравенства по доходам, а также более высокой долей занятости на крупных предприятиях. 

Во-вторых, в работе оценивается величина спилловер-эффектов фискальной политики, т. е. воздействия фискального стимула в одном регионе на экономику его соседей. Показано, что величина этих эффектов зависит как от размера и структуры ВРП, так и от интенсивности внешней торговли с другими регионами и странами, а также состояния регионального рынка труда. Эти результаты подтверждают, что предположение об однородности пространственных взаимосвязей является избыточно строгим [@demidovaProstranstvennoAvtoregressionnayaModel2014].

Наконец, результаты исследования подтверждают наличие связи между эффектами макроэкономической политики и внутри- и межрегиональным неравенством. В работе показано, что эффективность бюджетных расходов зависит от уровня экономического развития региона и дифференциации доходов домохозяйств. Выводы схожего характера были получены ранее при анализе трансмиссии монетарной политики в России [@napalkovRazlichiyaEffektahEdinoy2021;@zverevaVliyanieVnutriregionalnogoNeravenstva2024; @zverevaReakciyaBankovskihStavok2024].

Полученные результаты демонстрируют, что распределение государственных расходов в пространстве имеет макроэкономические последствия. Так, с точки зрения проведения контрциклической политики в периоды экономического спада более эффективным будет наращивание расходов в крупных регионах с высокой дифференциацией доходов населения. Такая политика, однако, будет приводить к умеренному увеличению межрегионального неравенства, динамика которого сглаживается благодаря положительным пространственным экстерналиям.

# Методология исследования {-}

Для оценки фискального мультипликатора чаще всего используются структурные векторные авторегрессии [@rameyCanGovernmentPurchases2011]. Такой подход не вызывает проблем при работе на национальном уровне, но при применении на региональных данных может приводить к смещению оценок мультипликаторов из-за недоучёта спилловер-эффектов. Последние чаще всего оцениваются с помощью инструментария пространственной эконометрики, который в стандартном случае ограничивается одной зависимой переменной и подразумевает симметричность пространственных связей. Расширение до многомерного случая с неоднородными связями между регионами сопряжено со значительным усложнением процедуры оценки параметров, поскольку пространственный лаг в таких моделях считается эндогенным [@elhorstCrossSectionalDependenceSpillovers2021].

В данной работе сделан выбор в пользу глобальной векторной авторегрессии (GVAR) [@pesaranModelingRegionalInterdependencies2004]. С эконометрической точки зрения, GVAR представляет собой обобщение моделей с пространственным лагом. В обоих случаях связи между регионами описываются взвешивающей матрицей. Отличие между двумя классами моделей состоит в предпосылках о структуре этой матрицы. Для разреженных (sparse) матриц, часто используемых в пространственных моделях^[К таким матрицам относятся, например, граничные матрицы, в которых у региона малое число тесно связанных с ним соседей], эндогенность значений переменных в соседних регионах делает МНК-оценки несостоятельными. Если же связи между регионами описываются плотной (dense) матрицей, то параметры модели могут быть оценены с помощью МНК [@elhorstCrossSectionalDependenceSpillovers2021]. В этом случае каждый регион считается малой открытой экономикой в монетарном союзе, и оценка региональных блоков проводится по отдельности. Оценённые индивидуальные модели с помощью взвешивающей матрицы объединяются в систему, решение которой позволяет осуществлять прогнозирование или структурный анализ [@pesaranModelingRegionalInterdependencies2004]. Таким образом, GVAR позволяет оценивать специфические для каждого региона коэффициенты при межвременных и пространственных связях, при этом обеспечивая согласованное моделирование региональных экономик как единой системы.  

Изначально GVAR разрабатывались для анализа межстрановых связей, однако эта методология успешно применяется на отраслевом [@hiebertInternationalTradeTechnological2010], региональном [@vansteenkisteRegionalHousingMarket2007] и городском уровне [@hollySpatialTemporalDiffusion2011]. В России GVAR применялись для оценки влияния внешнеэкономических шоков [@zubarevPostroenieModeliGVAR2023] и неоднородности реакции регионов на шоки ДКП [@napalkovRazlichiyaEffektahEdinoy2021]. 

Поскольку публичные данные о распределении расходов федерального бюджета по субъектам отсутствуют, в данной работе мы фокусируемся на последствиях шоков расходов региональных бюджетов и возникающих спилловер-эффектах. Под региональными бюджетными расходами мы понимаем изменение расходов консолидированного бюджета субъекта, включающее расходы входящих в него муниципалитетов. 

Данные квартальной или, тем более, годовой частоты не позволяют качественно моделировать взаимосвязи между макроэкономическими показателями регионов России. В первую очередь это связано с тем, что меры фискальной политики обладают коротким внешним лагом трансмиссии и влияют на экономику региона внутри одного года, в то время как внутренний лаг (лаг принятия решений) является гораздо более существенным [@christianoWhenGovernmentSpending2011]. Кроме того, использование данных меньшей частоты неминуемо приводит к резкому сокращению числа наблюдений и снизит точность оценок параметров. Исходя из этого, в работе отдаётся предпочтение данным месячной частоты.

```{r ModelStructure, fig.cap = "Структура GVAR-модели", fig.ext='png', fig.width = 6.5, engine.opts = opts, engine=engine}
\usetikzlibrary{calc,positioning,patterns,angles,intersections,ext.paths.ortho,shapes.multipart,fit,matrix,shadows,shadows.blur,arrows,shapes,arrows.meta,positioning,decorations.pathreplacing,quotes}
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}
\newsavebox{\test}
\savebox{\test}{\begin{tikzpicture}[%
    ,node distance=5mm
    ,>=latex'
    ,blockbig/.style = {%
    ,draw
    ,minimum height=10mm,minimum width=28mm
    ,align=center
    }
    ,blocksmall/.style = {%
    ,draw
    ,minimum height=7mm,minimum width=10mm
    ,align=center
    }
    ,blocksmalltext/.style = {%
    ,draw=black!60
    ,minimum height=10mm,minimum width=20mm
    ,align=center,
    font={\footnotesize}
    }
    ,textsmall/.style = {%
    ,minimum height=7mm,minimum width=10mm
    ,align=center,
    font={\footnotesize}
    }
    ,every path/.style={->} 
    ] 
\node[blocksmalltext, anchor = south west] (exp1) {Расходы\\бюджета};
\node[below = 0.1 cm of exp1] (num) {\circled{1}};
%\node[blocksmalltext, right = of exp1] (wage1) {Заработные\\платы};
\node[blocksmalltext, below left = 0.5 cm and -0.5 cm of exp1] (y1) {Выпуск};
\node[blocksmalltext, below right = 0.5 cm and -0.5 cm of exp1] (infl1) {Инфляция};
%\draw[<->] (exp1.east) -- (wage1.west);
%\draw[<->] (wage1.south west) -- (y1.north east);
%\draw[<->] (infl1.east) -- ($(infl1.east) +(0.2,0)$) |- (wage1.east); 
\draw[<->] (y1.east) -- (infl1.west);
\draw[<->] (y1.west) -- ($(y1.west) +(-0.2,0)$) |- (exp1.west);
\draw[<->] (infl1.east) -- ($(infl1.east) +(0.2,0)$) |- (exp1.east); 
\end{tikzpicture}}
\begin{tikzpicture}[%
    ,node distance=5mm
    ,>=latex'
    ,blockbig/.style = {%
    ,draw
    ,minimum height=10mm,minimum width=28mm
    ,align=center
    }
    ,blocksmall/.style = {%
    ,draw
    ,minimum height=7mm,minimum width=10mm
    ,align=center
    }
    ,blocksmalltext/.style = {%
    ,draw=black!60
    ,minimum height=10mm,minimum width=20mm
    ,align=center,
    font={\footnotesize}
    }
    ,textsmall/.style = {%
    ,minimum height=7mm,minimum width=10mm
    ,align=center,
    font={\footnotesize}
    }
    ]
    \node (r1) {\usebox{\test}};
    \node[right = of r1.south east] (r2) {$\dots$};
    \node[right = 1.5 cm of r1] (rN) {\usebox{\test}};
    \draw[decorate,decoration={brace,mirror}] (r1.south west) --
        node[below,align=center] (regname1) {Регион 1\\VAR} (r1.south east);
    \draw[decorate,decoration={brace,mirror}] (rN.south west) --
        node[below,align=center] (regnameN) {Регион $N$\\VAR} (rN.south east);
    \node[blocksmalltext, below = 0.5 cm of r2] (tradeflows) {Матрица торговых потоков};
    \node[blocksmalltext, align = center, below = 0.5 cm of tradeflows] (external) {\hphantom{оо}Внешние переменные\hphantom{кв}};
    \draw[->] (regname1.south) |- (tradeflows);
    \draw[<-] (tradeflows) -| (regnameN.south);
    \draw[->] (tradeflows.south) -- (external);
    \draw[->] (external.west) -- ($(regname1.west|-external.west) + (-0.25,0)$) node[fill=white] {\circled{2}} |- (regname1.west);
    \draw[->] (external.east) -- ($(regnameN.east|-external.east) + (0.25,0)$) node[fill=white] {\circled{2}} |- (regnameN.east);
    \node[below = 0 cm of external.south] {Спилловер-эффекты};
    \draw[thick] ($(r1.north west) +(-0.2,0.2)$) rectangle ($(external.south-|rN.south east) + (0.2,-0.5)$);
    \node[blocksmalltext, above right = 1.1 cm of rN] (urals) {Цена Urals};
    \node[blocksmalltext, right = of urals] (fedbudg) {Фед.\\бюджет};
    \node[blocksmalltext, above = of urals] (exrate) {USD/RUB};
    \node[blocksmalltext, above = of fedbudg] (i) {Ставка\\RUONIA};
    \draw[<->] (urals.north) -- (exrate.south);
    \draw[<->] (urals.east) -- (fedbudg.west);
    \draw[<->] (i.south) -- (fedbudg.north);
    \draw[<->] (exrate.east) -- (i.west);
    \draw[<->] (exrate.south east) -- (fedbudg.north west);
    \draw[<->] (i.south west) -- (urals.north east);
    \node[textsmall, above = -0.05 cm of $(exrate.north)!0.5!(i.north)$, align=center] (global) {Глобальные переменные};
    \draw[thick] ($(urals.north west) +(-0.2,2.6)$) rectangle ($(fedbudg.south east) + (0.2,-0.2)$);
    \draw[->] ($(urals.west) +(-0.2,0)$) -| node[near start, above, xshift=-0.05cm] {Влияние общих факторов} ($(tradeflows.north|-urals.west) + (0,-1)$);
    \draw[<-] ($(urals.south)!0.5!(fedbudg.south) +(0,-0.2)$) |- node[midway, below, align = center] {Функция реакции\\правительства} ($(rN.east) + (0.2,0)$);   
    \node[above = -0.25 cm of global] {\circled{3}};
\end{tikzpicture}
```
`r figNote('цифрами отмечены блоки переменных: региональные (1), внешние (2) и глобальные (3). Взаимосвязи между переменными обозначены стрелками.')`

Структура предлагаемой модели для российской экономики приведена на Рисунке \@ref(fig:ModelStructure). Переменные в ней делятся на три блока^[Подробнее об источниках и построении переменных см. онлайн-приложение]:

1. **Региональные переменные** включают логарифм индекса деловой активности ($100\log(y_{it})$), инфляцию в виде лог-разностей регионального ИПЦ ($100\log(P_{it})$), а также исполнение расходов консолидированного бюджета субъекта на душу населения в реальном выражении ($\log(g_{it})$). 
2. **Внешние переменные** представляют собой уникальную для каждого региона взвешенную комбинацию региональных переменных, относящихся к его регионам-соседям. В качестве взвешивающей матрицы мы применяем матрицу межрегиональных торговых потоков за 2016 год^[Конструирование подобной матрицы из статистики, опубликованной после 2016 года, не представляется возможным, так как Росстат перестал публиковать агрегированные данные о межрегиональных торговых потоках] по данным Росстата.
3. **Глобальные переменные** включают общие для всех регионов России факторы: ставку денежного рынка RUONIA ($i_t$), а также логарифмы цены на нефть марки Urals ($\log(poil_t)$), валютного курса рубля к доллару ($\log(e_t)$), расходов ($\log(g_t)$) и доходов ($\log(tx_t)$) федерального бюджета. 

Динамика переменных первого блока описывается VAR-моделью в каждом из $N$ регионов. В эту модель в качестве слабо экзогенных входят внешние переменные (блок 2). Переменные блока 3 позволяют учесть влияние факторов, воздействующих на все регионы одновременно, таких как конъюнктура внешних рынков или макроэкономическая политика на федеральном уровне. При этом глобальные переменные могут реагировать на агрегированную региональную динамику. Например, уравнение ставки процента представляет собой вариант правила Тейлора, а доходы федерального бюджета зависят от деловой активности в регионах. 

Выборка ограничена периодом с ноября 2009 г. по апрель 2024 г. из-за отсутствия более ранних помесячных данных о региональной деловой активности. Из-за неудовлетворительного качества и отсутствия некоторых исходных данных, из анализа исключаются Ненецкий, Ханты-Мансийский, Ямало-Ненецкий и Чукотский автономные округа, а также Республика Крым и Севастополь. В результате мы оцениваем 79 региональных моделей и 1 дополнительную модель для глобальных переменных.

В общем виде уравнение модели для региона $i$ имеет следующий вид:

:::{custom-style="equation"}
&#9; $\vect{x}_{it} = \vect{a}_{i0} + \vect{a}_{i1} t + \vect{\Phi}_{i1} \vect{x}_{i,t-1} + \sum_{l=0}^{1} \vect{\Lambda}_{il} \vect{x}^*_{i,t-l} + \sum_{l=0}^{1} \vect{D}_{il} \vect{\omega}_{t-l} + \varepsilon_{it}$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

где $\vect{x}_{it}$ - вектор эндогенных переменных, $\vect{x}^*_{i,t}$ - вектор специфических для региона внешних переменных, $\vect{\omega}_t$ - вектор глобальных переменных. Матрицы $\vect{\Phi}_{i1}$, $\vect{\Lambda}_{il}$ и $\vect{D}_{il}$ содержат оцениваемые коэффициенты, а вектор $\varepsilon_{it} \sim \mathcal{N} (0, \Sigma_{it})$ представляет собой случайные ошибки для региона $i$. В каждую модель включена константа $\vect{a}_{i0}$ и линейный тренд $\vect{a}_{i1} t$, поскольку переменные входят в модель в лог-уровнях. Порядок лага для всех видов переменных задаётся равным 1.

Внешние переменные рассчитываются как взвешенное среднее эндогенных переменных:

:::{custom-style="equation"}
&#9; $\vect{x}^*_{it} = \sum_{j=1}^{N} \nu_{ij} \vect{x}_{jt}$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

где $\nu_{ij}$ - вес, характеризующий силу экономических связей между регионами. При этом $\nu_{ii} = 0$ и $\sum_{j=1}^N \nu_{ij} = 1$.

Для глобальных переменных специфицируется отдельная VAR-модель:

:::{custom-style="equation"}
&#9; $\vect{\omega}_t = \vect{\Phi}_{\omega 1} \vect{\omega}_{t-1} + \vect{\Lambda}_{\omega 1} \vect{x}^*_{\omega,t-1} + \eta_{\omega t}$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

где $\vect{\Phi}_{\omega 1}$ - матрица коэффициентов при лаговых значениях, а вектор $\eta_{it} \sim \mathcal{N} (0, \tilde{\Sigma}_{it})$ представляет собой случайные ошибки модели. Ненулевая матрица $\vect{\Lambda}_{\omega 1}$ позволяет глобальным переменным зависеть от лаговых значений региональных средних $\vect{x}^*_{\omega,t-1}$. 

Для оценки параметров модели применяется байесовский подход. На коэффициенты региональных моделей накладывается вариант априорного распределения Миннесоты. Он предполагает, что объясняющая способность выше для 1) собственных лаговых значений по сравнению с лагами других переменных, и 2) более близких лагов по сравнению с дальними. Модель оценивается в среде R с помощью пакета BGVAR [подробнее см. @boeckBGVARBayesianGlobal2022]. Сэмплирование из апостериорных распределений параметров производится при помощи метода Монте-Карло для марковских цепей (MCMC). В алгоритме используются 16 000 итераций, первые 15 000 которых отбрасываются для минимизации влияния начальных значений на сходимость цепи. Поскольку выборка включает в себя качественно отличающиеся периоды (посткризисное восстановление 2009 - 2010 гг., спад 2015 - 2016 гг., а также шок 2022 г.), мы оцениваем модель со стохастической волатильностью остатков. 

F-тест на автокорреляцию в остатках модели демонстрирует, что для 127 из 242 переменных гипотеза об отсутствии автокорреляции не отвергается на 1% уровне значимости^[Увеличение порядка лагов снижает долю значимых автокорреляций, однако приводит к существенному увеличению параметризации модели и времени её оценки, а также делает некоторые региональные VAR нестабильными. Величина медианного отклика деловой активности устойчива к изменению порядка лага.]. Перед работой с моделью проводится диагностика сходимости марковских цепей к целевому распределению. Тест Гевеке, сравнивающий среднее значение параметра в начале и конце цепи, демонстрирует, что на 95%-м уровне значимости можно констатировать сходимость для `r conv`% параметров. 

```{r Crosscorr, tab.id = "Crosscorr"}
 summ$crosscorrdata[,1:3] %>%
   as.data.frame(.) %>%
   rownames_to_column() %>%
   left_join(summ$crosscorr[,1:3] %>%
   as.data.frame(.) %>%
   rownames_to_column(), by = 'rowname') %>%
   relocate(exp.y, .before = y.x) %>%
   relocate(y.y, .before = pi.x) %>%
   flextable() %>%
   add_header_row(values = c(" ", "Госрасходы", "Деловая активность", "Инфляция"), colwidths = c(1, 2,2,2)) %>%
   labelizor(part = "header", labels = c("rowname" = "Коэффициент корреляции", "exp.x" = "Данные", "exp.y" = "Остатки модели", "y.x" = "Данные", "y.y" = "Остатки модели", "pi.x" = "Данные", "pi.y" = "Остатки модели")) %>%
  add_footer_lines("Примечание: в таблице приведено число и доля регионов, для которых средний коэффициент корреляции между региональными переменными (или остатками уравнений модели) лежит в указанном диапазоне") %>%
   tabForm(cap = 'Средние коэффициенты корреляции между переменными и остатками модели в регионах России')
```

Одно из ключевых допущений GVAR-анализа предполагает, что большая часть одномоментной корреляции между региональными переменными объясняется динамикой внешних переменных. Иными словами, после включения слабо-экзогенных внешних переменных остатки модели для различных регионов должны быть слабо коррелированы между собой. Выполнение этой предпосылки проверяется в Таблице \@ref(tab:Crosscorr). Для каждой переменной в выбранном регионе рассчитывается коэффициент её корреляции с аналогичной переменной в других регионах. Затем этот коэффициент корреляции усредняется, после чего подсчитывается число регионов, для которых этот коэффициент лежит в заданном диапазоне. Аналогичная процедура проводится для остатков региональных моделей. 

Исходные переменные (столбец "данные") ожидаемо высоко коррелированы между собой в большинстве регионов. Остатки модели для уравнений деловой активности и госрасходов, напротив, практически не демонстрируют выраженной корреляции, в то время как в остатках инфляции она сохраняется. Настоящая работа, однако, не ставит целью построение полной модели региональной или общероссийской инфляции. Ключевой интерес представляет моделирование реакции деловой активности на региональные шоки государственных расходов, чему необъяснённая корреляция в остатках инфляции не препятствует. 

# Оценка фискальных мультипликаторов в регионах России {-}

Как и в стандартных VAR, остатки GVAR-модели в приведённой форме не могут быть интерпретированы как структурные экономические шоки, так как они коррелируют друг с другом. Структурный анализ требует решения проблемы идентификации. Эта процедура предполагает использование экономической теории или иной внешней по отношению к модели информации, которая накладывает ограничения на отдельные элементы ковариационной матрицы и позволяет привести её к ортогональному виду. Применительно к шокам бюджетных расходов наиболее часто применяются рекурсивная [@fatasEffectsFiscalPolicy2001] или нарративная [@rameyGovernmentSpendingMultipliers2018] схемы идентификации, а также знаковые ограничения [@mountfordWhatAreEffects2009].

В этой работе используется рекурсивная схема идентификации. В частности, предполагается, что в рамках одного месяца региональные шоки спроса и предложения не оказывают влияния на величину государственных расходов, а сами госрасходы могут одномоментно влиять на другие переменные в регионе^[Основные выводы работы устойчивы к использованию альтернативной идентификационной стратегии в виде знаковых ограничений. Результаты расчётов приведены в онлайн-приложении]. Эта предпосылка является обоснованной, поскольку модель оценивается на данных о кассовом исполнении региональных бюджетов, которые фиксируют бюджетные расходы в момент их перечисления бюджетополучателям. Поскольку расходы бюджета утверждаются заранее и бюджетный процесс не позволяет изменять их внутри месяца, реагируя на текущую экономическую статистику, мы можем исключить влияние текущей деловой активности и инфляции на их величину. Отметим, что идентификация в GVAR-моделях является локальной: шок госрасходов ортогонален другим региональным шокам, но может коррелировать с шоками расходов в других регионах. На практике эта корреляция оказывается положительной, но пренебрежительно слабой (см. Таблицу \@ref(tab:Crosscorr)).

Поскольку регионы России отличаются между собой как по объёму бюджетных расходов, так и по численности населения, импульсные отклики идентифицированной модели нуждаются в трансформации для обеспечения их сопоставимости. В качестве меры реакции деловой активности на шок госрасходов в регионе $j$ используется мультипликатор, который отражающет процентное изменение деловой активности в регионе $i$ в ответ на рост госрасходов, эквивалентный 1% подушевого ВРП региона $j$:

:::{custom-style="equation"}
&#9; $mult^y_{ijh} = IRF^{y,g}_{ijh} \times \frac{1}{\bar{g}_j} \times \overline{GRP}_j \times 0.01$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

где $IRF^{y,g}_{ijh}$ - функция импульсного отклика деловой активности в регионе $i$ на шок госрасходов в регионе $j$ на горизонте $h$, $\bar{g}_j$ - средний уровень расходов бюджета на душу населения в регионе $j$, а $\overline{GRP}_j$ - средний уровень ВРП на душу населения в реальном выражении^[В обоих случаях средние рассчитаны за весь период наблюдений]. Для расчёта "собственных" мультипликаторов в приведенной формуле $j=i$, а для расчёта спилловер-эффектов $j\neq i$.

```{r OwnY, tab.id = "OwnY"}
tableY %>%
  filter(!type %in% c('Weighted Median'
                      ,'CU_l','CU_u'
                      )
         )%>%
  mutate(type = c('Минимум',
                  '15-й перцентиль',
                  'Медиана',
                  '85-й перцентиль',
                  'Максимум',
                  'Среднее',
                  'Доля значимых'
                  #,'Средняя нижняя граница 68% интервала',
                  #'Средняя верхняя граница 68% интервала'
                  )) %>%
  select(`Статистика`=type, `0`, `1`, `3`, `6`, `12`, `24`) %>%
  flextable() %>%
  add_header_row(values = c(" ", "Горизонт (месяцев)"), colwidths = c(1,6)) %>%
  add_footer_lines('Примечание: оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. Под мультипликатором понимается процентное изменение индекса деловой активности в ответ на увеличение госрасходов, эквивалентное 1% ВРП. Расчёт произведён по 79 регионам согласно формуле (4).') %>%
  footnote(i = 6:7, j = 1,
  value = as_paragraph(
    c("При расчёте среднего в качестве весов используется региональный подушевой ВРП", 
    "Для проверки значимости используются 68%-е достоверные интервалы")
    ),
  ref_symbols = c("1", "2"),
  part = "body"
  ) %>%
  tabForm(cap = 'Оценка мультипликатора государственных расходов в российских регионах')
```

```{r OwnYDynReg, fig.cap='Динамика мультипликатора государственных расходов в российских регионах', fig.width=6.59, dpi=170}
multY %>%
  ggplot() +
  geom_line(aes(x=h, y=value, group = OKATO_id), linewidth = 0.5, linetype = 'dotted', colour = 'gray') +
  geom_line(data = tableY %>%
              filter(type == 'Weighted Mean') %>%
              pivot_longer(-type) %>%
              mutate(name = as.factor(name)),
            aes(x=name, y=value, group = 1, linetype = 'dashed'), colour = 'black', linewidth = 1.25) +
  geom_line(data = tableY %>%
              filter(type == '50%') %>%
              pivot_longer(-type) %>%
              mutate(name = as.factor(name)),
            aes(x=name, y=value, group = 2, linetype = 'solid'), colour = 'black', linewidth = 1.25) +
  scale_linetype_identity(breaks = c('solid', 'dashed'),
                          labels = c("Медиана", "Взвешенное среднее"),
                          guide = "legend") +
  guides(linetype=guide_legend(ncol=2)) +
  theme_hse() +
  labs(x = 'Горизонт, месяцев',
       y = '%',
       linetype = "Guide name"
       # title = "Экономические показатели российских регионов",
       # caption = "Источник: Росстат, Федеральное Казначейство, расчёты автора"
  ) + 
  ylim(c(tableY[1,-1] %>% min(), tableY[5,-1] %>% max())) +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 18),
    axis.text = element_text(size = 20),
    axis.title.y.left = element_markdown(size = 18, margin = margin(r = 0, l = 0, unit = "cm")),
    axis.title.x = element_markdown(size = 18, angle = 0, vjust = 1.05, margin = margin(r = 0, l = 0, unit = "cm")),
    legend.key.size = unit(3,"line")
    # plot.title = element_markdown(lineheight = 1.1, size = 20),
    # plot.subtitle = element_markdown(lineheight = 1.1, size = 18),
    # plot.caption = element_markdown(family = "HSE Sans", lineheight = 1.1, hjust = 1, size = 16, face = "italic"),
    # # aspect.ratio = 0.56,
    # strip.text = element_markdown(size = 16,lineheight = 0.4),
    # strip.background = element_rect(fill = 'white'),
    # panel.border = element_rect(colour = "black", fill = NA)
  )
```
`r figNote('оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. Отклики деловой активности в отдельных регионах изображены пунктирной линией.')`

Оценённая динамика отклика деловой активности в регионах после шока госрасходов, эквивалентного 1% подушевого ВРП, приведена на Рисунке \@ref(fig:OwnYDynReg), а ключевые описательные статистики, характеризующие распределение полученных мультипликаторов, приведены в Таблице \@ref(tab:OwnY). В подавляющем большинстве регионов отклик имеет ожидаемый положительный знак в момент шока: деловая активность положительно реагирует на рост государственных расходов. Его величина значима примерно в половине регионов. Влияние госрасходов на деловую активность достигает своего пика в среднем через `r YMaxHor` месяца после шока: медианный мультипликатор на этом горизонте равен `r YMax`%, а средневзвешенный^[Здесь и далее при взвешивании региональных показателей используется реальный подушевой ВРП] - `r YMaxMean`%. При этом влияние шока характеризуется высокой персистентностью и сохраняется положительным на горизонте до двух лет. Результаты расчётов для каждого региона в отдельности доступны в онлайн-приложении. 

Помимо оценок прямых эффектов бюджетных расходов на экономику регионов, мы также рассчитываем среднюю величину двух спилловер-эффектов: spill-out и spill-in. Эффект spill-out ($SO_j$) отражает, насколько сильно другие регионы реагируют на шоки бюджетных расходов в регионе $j$:

:::{custom-style="equation"}
&#9; $SO_j = \sum_{i\neq j} \omega_{i} mult^y_{ijh}$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

Эффект spill-in ($SO_j$), напротив, определяется как чувствительность заданного региона $j$ к государственным расходам в других регионах:

:::{custom-style="equation"}
&#9; $SI_j = \sum_{i\neq j} \omega_i mult^y_{jih}$,&#9;`r officer::run_autonum(seq_id = 'eq', pre_label = '(', post_label = ')')`
:::

В обоих случаях $\omega_i=\frac{GRP_i}{\sum_k GRP_k}$ представляет собой долю региона в суммарном объёме ВРП регионов России.

```{r SpillY, tab.id = "SpillY"}
tableYOut %>%
  left_join(tableYIn, by = 'Статистика', suffix = c('','.')) %>%
  mutate(`Статистика` = c('Минимум',
                  '15-й перцентиль',
                  'Медиана',
                  '85-й перцентиль',
                  'Максимум',
                  'Среднее',
                  'Доля значимых'
                  )) %>%
  flextable() %>% 
  add_header_row(values = c(" ", "Эффект spill-out", "Эффект spill-in"), colwidths = c(1,6,6)) %>%
  add_header_row(values = c(" ", "Горизонт (месяцев)"), colwidths = c(1,12)) %>%
  labelizor(part = "header", labels = c("0." = "0", "1." = "1", "3." = "3", "6." = "6", "12." = "12", "24." = "24")) %>%
  add_footer_lines('Примечание: оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. Во всех случаях размер шока нормализован к 1% ВРП региона-источника шока. Расчёт произведён по 79 регионам.') %>%
  footnote(i = 2, j = c(2,8),
  value = as_paragraph(
    c(
      "Spill-out эффект представляет собой усреднённую реакцию деловой активности всех других регионов на шок госрасходов в заданном регионе",
      "Spill-in эффект отражает чувствительность деловой активности заданного региона к шокам госрасходов во всех других регионах"
    )),
  ref_symbols = c("1", "2"),
  part = "header"
  ) %>%
    footnote(i = 7, j = 1,
  value = as_paragraph(c("Для проверки значимости используются 68%-е достоверные интервалы")),
  ref_symbols = c("3"),
  part = "body"
  ) %>%
  tabForm(cap = 'Оценка величины спилловер-эффектов в ответ на шок расходов бюджета в российских регионах') 
```

Полные результаты расчётов по каждому региону доступны в онлайн-приложении. Спилловер-эффекты оказываются достаточно выражены (см. Таблицу \@ref(tab:SpillY)). На горизонте 1 года 1%-й рост подушевых госрасходов в одном регионе приводит к росту деловой активности других регионов в среднем на `r tableYOut[6,6] %>% as.numeric() %>% round(.,2)`%. Средний регион России реагирует на изменение расходов бюджета в других регионах на `r tableYIn[6,6] %>% as.numeric() %>% round(.,2)`%. В обоих случаях около 75% откликов значимо отличаются от нуля.
 
# Факторы неоднородности региональных мультипликаторов {-}

Полученные результаты демонстрируют, что влияние бюджетных расходов на региональную экономику, а также сила возникающих спилловер-эффектов имеют выраженную региональную неоднородность. На карте (см. Рисунок \@ref(fig:OwnYMap)) приведено пространственное распределение отклика деловой активности на горизонте 3 месяцев, что приблизительно отражает пиковое воздействие шока бюджетных расходов на экономику. 

```{r OwnYMap, fig.cap='Оценка мультипликатора госрасходов на горизонте 3 месяцев', fig.width=6.59, dpi=400}
hor <- 3
limits <- multY %>%
  filter(h == hor) %>%
  pull(value) %>%
  quantile(GRADIENT_QUANTILE_LIMITS)
SIG_OPACITY <- 0.75
multY %>% 
  filter(h == hor) %>%
  filter(sig68) %>%
  ggplot() +
  geom_rect(aes(xmin=1, xmax=2, ymin=1, ymax=2, fill=value)) +
  geom_rect_pattern(data = multY %>% filter(h == hor) %>% filter(!sig68), 
                    aes(xmin=1, xmax=2, ymin=1, ymax=2
                        #,
                        #        pattern_alpha = !sig68,
                        #        alpha = !sig68
                        ),
                    color='black', pattern_fill  = 'white', fill = 'lightgray', pattern_spacing = 0.2, pattern_size = 0.15, pattern_angle = 120) +
  #scale_alpha_manual(values = c('TRUE' = SIG_OPACITY, 'FALSE' = 1)) + 
  #scale_pattern_alpha_manual(values = c('TRUE' = SIG_OPACITY, 'FALSE' = 0))  +
  scale_fill_gradient(limits = limits, oob = squish, low = "grey", high = "black") + 
  # Тонкая настройка подписей: <краткое название субъекта> <+/-> <значение>%
  geom_text(aes(x = 1.5, y = 1.5, label = paste0(name,'\n', round(value,2), '%')),
            col="white", size=12, lineheight = 0.3) +
  geom_text(data = multY %>% filter(h == hor) %>% filter(!sig68), aes(x = 1.5, y = 1.5, label = paste0(name,'\n', round(value,2), '%')),
            col="black", size=12, lineheight = 0.3) +
  geom_text(data = multY %>% right_join(grid %>% rename("OKATO_id"="code")) %>% filter(is.na(region)), aes(x = 1.5, y = 1.5, label = name),
          col="black", size=12, lineheight = 0.3, inherit.aes = FALSE) +
  facet_geo(~ OKATO_id, grid = grid) +
  labs(x='', y='') +
  theme(panel.background = element_rect(fill = 'lightgray', colour = 'black'),
        legend.position = 'none',
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(),
        plot.caption = element_text(size = 20),
        strip.placement = "bottom",
        strip.background = element_blank(),
        strip.text.x = element_blank(),
        line = element_blank(),
        panel.spacing = unit(-2, "points")
  ) 
```
`r figNote('оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. Величина значимых откликов обозначена градиентом, а незначимые отклики - штриховкой. Светло-серым цветом обозначены регионы, исключённые из анализа.')`

Импульсные отклики региональной деловой активности имеют достаточно широкие достоверные интервалы, что вызвано в первую очередь достаточно коротким интервалом оценки модели, её высокой параметризацией и, в некоторых случаях, низким качеством исходных статистических данных^[В ряде случаев региональные ряды динамики промышленного производства и потребительских отраслей имеют высокую волатильность, связанную с особенностями методики расчёта]. На аналогичный результат указывают @napalkovRazlichiyaEffektahEdinoy2021, анализируя отклик регионального уровня цен на шоки монетарной политики. При этом авторы отмечают, что поиск закономерностей в наблюдаемой реакции региональных переменных в любом случае представляет интерес. Руководствуясь этой логикой, в этом разделе мы проверяем связь отклика деловой активности с характеристиками регионов.

Теоретическая литература предсказывает, что ключевой фактор, определяющий размер мультипликатора - характер торговых и производственных между регионом и его партнёрами. Чем интенсивнее регион торгует с соседями, тем ниже окажется фискальный мультипликатор и сильнее величина спилловер-эффектов [@duporRegionalConsumptionResponses2023]. Формализуя эту идею в пространственной модели общего равновесия, @norrisFiscalMultipliersIntegrated2019 предсказывает, что наибольшим эффектом на ВВП страны будут обладать расходы, концентрирующиеся в регионах с дефицитом торгового баланса по отношению к другим регионам. @bernardiniHeterogeneousGovernmentSpending2020 показывают эмпирически, что перераспределение фиксированного объема госрасходов в пользу таких регионов имеет стимулирующий эффект.

DSGE-модели открытой экономики, в которых два региона составляют федерацию, демонстрируют, что величина спилловер-эффектов также может зависеть от способа финансирования расходов: за счёт дефицита местного бюджета или трансфера из федерального бюджета, финансируемого пропорционально всеми членами союза [@chodorow-reichGeographicCrossSectionalFiscal2019]. Среди других факторов, влияющих на величину фискального мультипликатора, выделяют композицию госрасходов и их распределение между трудо- и капиталоёмкими отраслями [@juarrosHeterogeneousSpendingHeterogeneous2023], уровень внутри- и межрегионального неравенства и остроту кредитных ограничений [@bernardiniHeterogeneousGovernmentSpending2020;@debuque-gonzalesLocalFiscalMultipliers2021].

Исходя из этих соображений и доступности региональных данных, в качестве потенциальных факторов гетерогенности в данной работе выделяются^[Если не указано иное, используются средние за период 2017 - 2023 гг.]:

1. размер и структура экономики: реальный ВРП на душу населения, доля добывающей, обрабатывающей промышленности и строительства в ВРП
1. распределение доходов: децильный коэффициент и доля населения с доходами ниже границы бедности
1. региональный рынок труда: уровень безработицы, напряжённость рынка труда (число безработных на одну вакансию), доля занятых в организациях с негосударственной формой собственности, доля занятых на малых и средних предприятиях^[Среднее за 2019 - 2023 гг.]
1. внешнеторговые связи: доля импорта из-за рубежа в ВРП, отношение отгрузки продукции из других регионов России и в другие регионы России к отгрузке в регион^[По данным Росстата о межрегиональной торговле за 2016 г.]
1. региональный бюджет: уровень регионального долга к ВРП (за исключением бюджетных кредитов), доля расходов регионального бюджета на национальную оборону, безопасность, национальную экономику и социальную сферу

В качестве зависимой переменной используется отклик деловой активности, а также средняя величина spill-out и spill-in эффекта для региона на горизонте 3 месяцев.

```{r Yregress, tab.id = "Yregress"}
hor <- 3
modelData <- horizonY %>%
  filter(h == hor) %>%
  rename(y = value) %>%
  select(-c(sig68,grp)) %>%
  left_join(explanatory %>% select(-c(OKATO,sport,state,culture,utilities)))
# GRP and Structure
m1 <- lm(y ~ log(GRP) + extraction + industry + construction, modelData,
             weight = GRP)
m1r <- coeftest(m1, vcov = vcovHAC, save = TRUE)
# Liquidity constraints
m2 <- lm(y ~ decile_coeff + poverty, modelData,
             weight = GRP)
m2r <- coeftest(m2, vcov = vcovHAC, save = TRUE)
m2r <- coeftest(m2, vcov = vcovHAC, save = TRUE)
# Labour market
m3 <- lm(y ~ tightness + unemprate + private_empl_share + sme_empl_share, modelData,
             weight = GRP)
m3r <- coeftest(m3, vcov = vcovHAC, save = TRUE)
# Trade
m4 <- lm(y ~ imgrp + exsh + imsh, modelData,
             weight = GRP)
m4r <- coeftest(m4, vcov = vcovHAC, save = TRUE)
# Budget
m5 <- lm(y ~ defense + security + economy + social + debtgrp, modelData,
             weight = GRP)
m5r <- coeftest(m5, vcov = vcovHAC, save = TRUE)
# Table
ts <- officer::fp_tabs(
  officer::fp_tab(pos = .4, style = "decimal"),
  officer::fp_tab(pos = 1.2, style = "decimal")
)
tab <- huxreg("ВРП" = m1, "Неравенство" = m2, "Рынок труда" = m3, "Внешняя торговля" = m4, "Бюджет" = m5, number_format = 2, statistics = c("N" = "nobs", 
      "R^2" = "r.squared", "R^2 adj." = "adj.r.squared", "F statistic" = "statistic",
      "P value" = "p.value"), bold_signif = 0.1, stars = c(`*` = 0.1, `**` = 0.05, `***` = 0.01),
      coefs = c("Константа" = "(Intercept)"
                ,"Логарифм ВРП на душу" = "log(GRP)",
                "Доля добычи в ВРП" = "extraction",
                "Доля обработки в ВРП" = "industry",
                "Доля строительства в ВРП" = "construction",
                "Децильный коэффициент" = "decile_coeff",
                "Уровень бедности" = "poverty",
                "Доля занятости в частном секторе" = "private_empl_share",
                "Доля занятости на МСП" = "sme_empl_share",
                "Напряжённость рынка труда" = "tightness",
                "Безработица" = "unemprate",
                "Импорт/ВРП" = "imgrp",
                "Отгрузка товаров из других регионов" = "imsh",
                "Отгрузка товаров в другие регионы" = "exsh",
                "Расходы на нацоборону" = "defense",
                "Расходы на нацбезопасность" = "security",
                "Социальные расходы" = "social",
                "Расходы на нацэкономику" = "economy",
                "Госдолг к ВРП" = "debtgrp"
                )) %>%
  set_align(., '.')
tab <- tab[-seq(3,39,2),]
tab %>%
  as_flextable() %>%
  add_footer_lines('Примечание: в качестве зависимой переменной используется оценка регионального мультипликатора на горизонте 3 месяцев. Наблюдения в регрессии взвешены по региональному подушевому ВРП') %>%
  tabForm(cap = 'Факторы гетерогенности отклика деловой активности на шок госрасходов') %>%
  flextable::align(align = 'left', part = 'all') %>%
  prepend_chunks(j = 2:5, as_chunk("\t")) %>%
  tab_settings(j = 2:5, value = ts) 
```

Из-за ограниченного числа наблюдений анализ проводится по отдельным блокам переменных. Результаты приведены в Таблице \@ref(tab:Yregress). 

Мультипликатор госрасходов оказывается выше в более богатых регионах (в расчёте на душу населения). Регионы с более высоким ВРП имеют более разнообразный и ёмкий внутренний рынок и, как следствие, могут иметь более низкую предельную склонность к импорту, что повышает величину мультипликатора. Среди факторов, связанных со структурой ВРП, обнаружена положительная взаимосвязь размера мультипликатора с долей строительной отрасли в ВРП. Это может объясняться дополнительным спросом, который предъявляет строительная отрасль на продукцию других отраслей, что увеличивает мультипликативный эффект. 

Кроме того, мультипликатор выше в регионах с высоким уровнем неравенства. Более выраженная дифференциация доходов жителей может приводить к появлению групп населения с высокой склонностью к потреблению. Шок государственных расходов приводит к росту деловой активности в отраслях, связанных с непосредственными бюджетополучателями, и росту доходов населения. Расходы домохозяйств с более высокой склонностью потреблению сильнее реагируют на динамику текущего дохода, что увеличивает фискальный мультипликатор.

```{r Yquantiles, tab.id = "Yquantiles"}
a <- modelData %>%
  group_by(q = ntile(GRP, 4)) %>%
  summarize(m = mean(y))
b <- modelData %>%
  group_by(q = ntile(decile_coeff, 4)) %>%
  summarize(m1 = mean(y))
c <- modelData %>%
  group_by(q = ntile(economy, 4)) %>%
  summarize(m2 = mean(y))
a %>%
  left_join(b) %>%
  left_join(c) %>%
  flextable() %>% 
  add_header_row(values = c(" ", "Признак группировки"), colwidths = c(1,3)) %>%
  labelizor(part = "header", labels = c("q" = "Квартиль переменной", "m" = "Подушевой ВРП", "m1" = "Децильный коэффициент", "m2" = "Расходы на нацэкономику")) %>%
  add_footer_lines('Примечание: оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. Во всех случаях размер шока нормализован к 1% ВРП региона-источника шока. Значения в таблице являются простым арифметическим средним. При расчёте квартилей значения независимых переменных сортированы по возрастанию.') %>%
  # footnote(i = 2, j = c(2,8),
  # value = as_paragraph(
  #   c(
  #     "Spill-out эффект представляет собой усреднённую реакцию выпуска всех других регионов на шок госрасходов в заданном регионе",
  #     "Spill-in эффект отражает чувствительность выпуска заданного региона к шокам госрасходов во всех других регионах"
  #   )),
  # ref_symbols = c("1", "2"),
  # part = "header"
  # ) %>%
  #   footnote(i = 7, j = 1,
  # value = as_paragraph(c("Для проверки значимости используются 68%-е достоверные интервалы")),
  # ref_symbols = c("3"),
  # part = "body"
  # ) %>%
  tabForm(cap = 'Средняя величина мультипликатора госрасходов при группировке регионов по различным признакам') 
```

Аналогичный эффект может ожидаться и по отношению к фирмам: малые предприятия гораздо чаще сталкиваются с ограничениями ликвидности, и должны активнее реагировать на положительные фискальные шоки из-за балансовых эффектов [@espinozaFiscalMultiplierPublic2024;@juarrosFiscalStimulusCredit2022]. Результаты анализа, однако, свидетельствуют об обратном: в регионах с высокой долей занятости на малых и средних предприятиях мультипликатор оказывается ниже. Это значит, что влияние фискальной политики на остроту кредитных ограничений для МСП является незначительным, а в общем эффекте доминируют крупные предприятия. Возможным объяснением такого результата может быть преобладание крупных предприятий среди получателей бюджетных средств, однако проверка этой гипотезы затруднена отсутствием соответствующих данных.  

Масштаб региональной неоднородности мультипликаторов представлен в Таблице \@ref(tab:Yquantiles). В ней приведён расчёт среднего мультипликатора в группах регионов по различным признакам. Так, в группе регионов с наименьшим уровнем подушевого ВРП мультипликатор составляет порядка 0.3, в то время как в наиболее богатых регионах он достигает 2.31. 

Выводы о региональной неоднородности мультипликаторов госрасходов являются, насколько известно автору, новыми в литературе. Полученные результаты свидетельствуют о том, что внутрирегиональное неравенство по доходам является одним из факторов, определяющих реакцию региона на фискальные шоки. Аналогичные выводы для денежно-кредитной политики были получены в литературе ранее [@zverevaVliyanieVnutriregionalnogoNeravenstva2024]. 

Как было показано выше, величина спилловер эффектов в целом невысока, что объясняется относительно небольшим размером региональных экономик. Наиболее сильно на другие регионы влияют бюджетные расходы в Москве и Московской области, Санкт-Петербурге и Тюменской области из-за их размера и тесных экономических связей с другими регионами. Формальный анализ факторов гетерогенности подтверждает эту гипотезу (см. Приложение 1): величина spill-out эффектов пропорциональна уровню подушевого ВРП региона, коэффициенту напряжённости регионального рынка труда и доле импорта в ВРП. При этом наиболее чувствительными к шокам бюджетных расходов в регионах-соседях оказываются регионы с наличием свободных трудовых ресурсов и высокой долей промышленности в ВРП. 

# Обсуждение результатов {-}

Рассчитанная величина мультипликатора госрасходов для большинства регионов находится в диапазоне оценок, известных в литературе. При этом они оказываются несколько выше существующих оценок национального фискального мультипликатора для России [@zyablickiyOcenkaFiskalnyhMultiplikatorov2020]. Это может быть связано с несколькими факторами. 

Во-первых, существующие исследования фокусируются на расходах федерального бюджета^[В отдельных случаях рассматривается консолидированный бюджет, примерно половина расходов которого приходится на федеральный], а в этой работе, напротив, получены фискальные мультипликаторы только для региональных расходов. Такой фокус продиктован отсутствием данных о распределении расходов федерального бюджета в региональном разрезе.  

Одной из причин отличий мультипликатора федеральных и региональных расходов может быть структура расходов бюджетов. В федеральном бюджете существенно выше доля "непродуктивных" расходов (общегосударственные вопросы, национальная оборона и безопасность), чем в региональных бюджетах. Предыдущие исследования оценивают мультипликативный эффект от расходов на силовые отрасли в 1.5 - 2 раза ниже, чем в случае расходов, стимулирующих накопление физического и человеческого капитала [@kudrinByudzhetnayaPolitikaKak2017]. Полученные результаты косвенно подтверждают эту гипотезу: мультипликатор оказывается выше в регионах с более высокой долей расходов на национальную экономику. 

Величину национального мультипликатора могут также снижать эффекты общего равновесия. Влияние этих эффектов на отличия между национальным и локальным фискальным мультипликатором было ранее изучено в DSGE-моделях валютных союзов [@nakamuraFiscalStimulusMonetary2014; @chodorow-reichGeographicCrossSectionalFiscal2019]. Повышение государственных расходов в отдельном малом регионе не оказывает существенного влияния на динамику общероссийского уровня цен и деловой активности. В результате повышение госрасходов на локальном уровне сопровождается более мягкой монетарной политикой, чем общестрановой шок. 
Помимо реакции монетарной политики, на величину мультипликатора в валютном союзе может влиять способ финансирования расходов [@chodorow-reichGeographicCrossSectionalFiscal2019]. Специфика российской бюджетной системы такова, что существенные дискреционные изменения налоговой политики на уровне отдельных регионов для финансирования тех или иных расходов практически невозможны. Кроме того, во многих регионах существенную долю доходов бюджета составляют трансферты из федерального бюджета^[В среднем в последние годы на межбюджетные трансферты приходилось около 20-25% доходов региональных бюджетов [@bashenkovVliyanieMezhbyudzhetnyhTransfertov2022]]. В результате увеличение расходов регионального бюджета финансируется пропорционально всеми членами союза и не приводит к пересмотру домохозяйствами ожидаемой траектории налогов и соответствующему уменьшению потребления. В случае фискальной экспансии на национальном уровне действие рикардианских эффектов может снижать величину мультипликатора.

Наконец, причина различий может быть методологической. Национальные мультипликаторы рассчитываются с использованием ВВП в качестве индикатора выпуска. В данном исследовании зависимой переменной выступает индекс деловой активности, рассчитанный по отраслям, доля которых в ВРП составляет от 20-30% (Республика Калмыкия, Камчатский край, Республика Ингушетия) до 80% и выше (Тюменская, Сахалинская, Кемеровская область, Красноярский Край). В результате мультипликаторы, оценённые с опорой на весь ВРП, могут отличаться от оценок по подмножеству его отраслей. Таким образом, отсутствие надёжных статистических данных по экономической активности в российских регионах препятствует полноценному сопоставлению результатов на национальном и региональном уровне.

Полученные результаты показывают, что при использовании бюджетных расходов в качестве контрциклического инструмента наибольшей эффективностью с точки зрения влияния на динамику деловой активности будут обладать расходы, концетрирующиеся в крупных и экономически успешных регионах. Однако влияния такой политики на межрегиональное неравенство неочевиден. 

```{r IneqDyn, fig.cap='Оценённая динамика индекса Джини для подушевого ВРП', fig.width=6.59, dpi=170}
rr <- readRDS('../Data/explanatory.RDS') %>%
  select(OKATO, OKATO_id, GRP) %>%
  arrange(GRP) %>%
  left_join(codes %>% select(region = Abbrev, name_rus = `Rus Name`, name_eng = Name, OKATO_id)) %>%
  filter(!is.na(region)) %>%
  arrange(GRP)
poor10 <- rr$region[1:10]
rich10 <- rr$region[70:79]

regineq <- read_excel('../Data/explanatory.xlsx', sheet = 'Ineq') %>%
  filter(OKATO_id %in% grp$OKATO_id) %>%
  select(-region) %>%
  left_join(codes %>% select(OKATO_id, region = Abbrev)) %>% 
  relocate(region, .before = OKATO_id)
g <- apply(regineq[,-c(1:4)] %>% as.matrix(), 2, DescTools::Gini, weights = regineq$population, na.rm=T)
# richest
# with spillovers
grps <- regineq %>%
  select(region, population, `2022`) %>%
  arrange(region)
mults <- readRDS(paste0(path,'/',MODEL,'-joint_10richest_chol.RDS')) %>%
    filter(variable == 'y') %>%
    ungroup() %>%
    select(region, h, Q50) %>%
    pivot_wider(names_from = 'h', values_from = 'Q50') %>%
    arrange(region)
sim <- as.vector(grps[,3]) * (1 + mults[,-c(1)]/100)
sim <- cbind(region = grps$region, population = grps$population, sim)
giniR <- apply(sim[,-c(1:2)] %>% as.matrix(), 2, DescTools::Gini, 
                weights = sim$population, 
                na.rm=T)
# without spillovers
mults2 <- mults
mults2[which(!mults$region %in% rich10),-1] <- 0 
sim2 <- as.vector(grps[,3]) * (1 + mults2[,-c(1)]/100)
sim2 <- cbind(region = grps$region, population = grps$population, sim2)
giniR2 <- apply(sim2[,-c(1:2)] %>% as.matrix(), 2, DescTools::Gini, 
                weights = sim2$population, 
                na.rm=T)
# poorest
mults <- readRDS(paste0(path,'/',MODEL,'-joint_10poorest_chol.RDS')) %>%
    filter(variable == 'y') %>%
    ungroup() %>%
    select(region, h, Q50) %>%
    pivot_wider(names_from = 'h', values_from = 'Q50') %>%
    arrange(region)
sim <- as.vector(grps[,3]) * (1 + mults[,-c(1)]/100)
sim <- cbind(region = grps$region, population = grps$population, sim)
giniP <- apply(sim[,-c(1:2)] %>% as.matrix(), 2, DescTools::Gini, 
                weights = sim$population, 
                na.rm=T)
# without spillovers
mults2 <- mults
mults2[which(!mults$region %in% poor10),-1] <- 0 
sim2 <- as.vector(grps[,3]) * (1 + mults2[,-c(1)]/100)
sim2 <- cbind(region = grps$region, population = grps$population, sim2)
giniP2 <- apply(sim2[,-c(1:2)] %>% as.matrix(), 2, DescTools::Gini, 
                weights = sim2$population, 
                na.rm=T)
# plot
ineqDf <- data.frame(h=0:24, gini = c(giniP, giniR, giniR2), group = c(rep('Сценарий 2', 25), rep('Сценарий 1', 25), rep('Сценарий 1 (без спилловер-эффектов)', 25)))
ineqDf %>%
  ggplot() +
  geom_line(aes(x=h, y=gini, group=group, linetype = group), linewidth = 1.25) +
  geom_hline(yintercept = g['2022'] %>% round(.,3), colour = 'black', linewidth = 1) +
  #annotate("text", x=15,y=g['2022'],label = paste0('Уровень 2022 года (', g['2022'] %>% round(.,3), ')'), vjust = -1, family = "Times New Roman") +
  scale_linetype_manual(values = c("Сценарий 1" = "dashed", "Сценарий 1 (без спилловер-эффектов)" = "dotdash", "Сценарий 2" = "dotted"),
                          guide = "legend") +
  theme_hse() +
  guides(linetype=guide_legend(ncol=3)) + 
  labs(x = 'Горизонт, месяцев',
       y = NULL,
       linetype = "Guide name"
       # title = "Экономические показатели российских регионов",
       # caption = "Источник: Росстат, Федеральное Казначейство, расчёты автора"
  ) + 
  #ylim(c(g['2022']-0.002, g['2022']+0.01)) +
  scale_y_continuous(breaks = seq(from = 0.312, to = 0.32, by = 0.001)) +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 18),
    axis.text = element_text(size = 20),
    axis.title.y.left = element_markdown(size = 18, margin = margin(r = 0, l = 0, unit = "cm")),
    axis.title.x = element_markdown(size = 18, angle = 0, vjust = 1.05, margin = margin(r = 0, l = 0, unit = "cm")),
    legend.key.size = unit(1.5,"line")
    # plot.title = element_markdown(lineheight = 1.1, size = 20),
    # plot.subtitle = element_markdown(lineheight = 1.1, size = 18),
    # plot.caption = element_markdown(family = "HSE Sans", lineheight = 1.1, hjust = 1, size = 16, face = "italic"),
    # # aspect.ratio = 0.56,
    # strip.text = element_markdown(size = 16,lineheight = 0.4),
    # strip.background = element_rect(fill = 'white'),
    # panel.border = element_rect(colour = "black", fill = NA)
  )
```
`r figNote('сценарий 1 предполагает увеличение госрасходов в 10 регионах с наибольшим подушевым ВРП (Тюменская, Сахалинская, Магаданская, Мурманская, Архангельская области, г. Москва, г. Санкт-Петербург, Республика Саха, Камчатский край, Республика Коми), сценарий 2 - в 10 регионах с наименьшим подушевым ВРП (Республики Ингушетия, Чечня, Кабардино-Балкария, Тыва, Карачаево-Черкесия, Дагестан, Северная Осетия, Адыгея, Бурятия, Ивановская область). Оценки получены на основе GVAR-модели на выборке 2009-2024 гг. с помощью рекурсивной схемы идентификации. При расчёте коэффициента Джини регионы взвешиваются по численности населения.')`

Для оценки влияния региональной фискальной политики на неравенство в настоящей работе используется следующий подход:

1. В качестве индикатора межрегионального неравенства используется коэффициент Джини для подушевого ВРП. Следуя существующим работам, при расчёте мы взвешиваем регионы по численности населения [@zubarevichNeravenstvoRegionovKrupnyh2019].  
1. С помощью оценённой GVAR-модели симулируется отклик региональных экономик на одновременное увеличение госрасходов в 10 наиболее богатых и 10 наиболее бедных регионов по подушевому ВРП.
1. Для каждого из двух сценариев предполагается, что динамика индекса деловой активности аппроксимирует динамику реального подушевого ВРП. На основании этой динамики рассчитывается коэффициент Джини.

Результаты симуляции приведены на Рисунке \@ref(fig:IneqDyn), а историческая динамика индекса приведена в онлайн-приложении. Из расчёта следует, что увеличение госрасходов в более богатых регионах приводит к повышению межрегионального неравенства, а в более бедных - к его снижению. Эффект является асимметричным: в сценарии 1 увеличение неравенства оказывается более сильным и устойчивым, чем в сценарии 2. Примечательно, что положительные спилловер-эффекты в сценарии 1 снижают рост неравенства практически в 4 раза. Таким образом, благодаря положительным пространственным экстерналиям и росту деловой активности в стране влияние региональной фискальной политики на неравенство оказываются небольшим по абсолютной величине. Существенный рост межрегионального неравенства возможен лишь при систематическом и долговременном росте госрасходов в наиболее богатых регионах. 

Отметим, что используемая методология и данные позволяют не ограничивать анализ последствий бюджетных шоков рассмотрением только динамики деловой активности. В частности, аналогичным образом могут быть рассчитаны мультипликаторы для уровня цен. Подобный расчёты показывают, что после роста расходов бюджета практически в половине регионов инфляция значимо снижается, и отклик сохраняется таковым на протяжении нескольких периодов^[Поскольку динамика региональной инфляции не является фокусом этой работы, эти результаты доступны от автора по запросу и не приводятся в основном тексте.]. Подобный результат, очевидно, не согласуется с выводами традиционных моделей, где фискальная политика влияет исключительно на сторону совокупного спроса. При этом отрицательная реакция уровня цен на шоки госрасходов документирована во множестве эмпирических работ и может быть обоснована теоретически в новокейнсианских DSGE-моделях за счёт влияния госрасходов на общую факторную производительность или уровень наценки монополистически конкурентных фирм [@jorgensenInflationResponseGovernment2022; @choiAreGovernmentSpending2022]. В свете этих результатов изучение вклада региональной бюджетной политики в инфляцию и её взаимодействия с единой денежно-кредитной политикой представляется особенно интересным в будущих исследованиях.

# Заключение {-}

Проведённое исследование демонстрирует, что фискальная политика оказывает неоднородное влияние на экономику российских регионов. Использование GVAR-модели позволило оценить не только локальные фискальные мультипликаторы, но и межрегиональные спилловер-эффекты. Результаты подтверждают, что бюджетные стимулы могут как напрямую повышать деловую активность в целевом регионе, так и оказывать воздействие на соседние регионы. Величина этих эффектов определяется не только размерами экономики, но и отраслевой структурой выпуска, уровнем неравенства, а также состоянием рынка труда и внешнеторговыми связями.

Показано, что повышение внутрирегионального неравенства по доходам ассоциируется с более высоким мультипликатором бюджетных расходов, что подтверждает наличие кейнсианских эффектов в трансмиссии фискальных шоков. Кроме того, фискальная политика оказывается более эффективной в регионах с высоким уровнем ВРП на душу населения. В таких регионах бюджетные стимулы приводят к более выраженному росту деловой активности, что может быть связано с более глубоким внутренним рынком, преобладанием сферы услуг в структуре экономики и более высокой долей крупных предприятий, способных быстрее реагировать на изменения в спросе. Вместе с тем, экономически развитые регионы обладают устойчивой налоговой базой, что расширяет доступное им "пространство для маневра" и позволяет проводить более мягкую фискальную политику. Такая политика может усиливать межрегиональное неравенство и требует проведения активной перераспределительной политики на федеральном уровне.

Таким образом, результаты исследования подтверждают сложную природу фискальной трансмиссии в экономике с большой межрегиональной и внутрирегиональной дифференциацией. Полученные результаты обосновывают необходимость дальнейшего изучения влияния фискальной политики с использованием дезагрегированных данных. Среди прочего, необходимо совершенствование способов оперативной оценки деловой активности в российских регионах, а также оценки её пространственного распределения. Перспективным направление будущих исследований может стать исследование эффектов фискальной политики с помощью гранулярных данных на уровне отдельных фирм или домохозяйств.

# Список использованной литературы {-}

<div id="refs"></div>

# Приложение 1. Факторы гетерогенности спилловер-эффектов {-}

```{r SpillOutRegress, tab.id = "SpillOutRegress"}
modelData <- tableregionspillY %>%
  select(OKATO, OKATO_id, y = `0`) %>%
  left_join(explanatory %>% select(-c(OKATO,sport,state,culture,utilities)))
# GRP and Structure
m1 <- lm(y ~ log(GRP) + extraction + industry + construction, modelData,
             weight = GRP)
m1r <- coeftest(m1, vcov = vcovHAC, save = TRUE)
# Liquidity constraints
m2 <- lm(y ~ decile_coeff + poverty, modelData,
             weight = GRP)
m2r <- coeftest(m2, vcov = vcovHAC, save = TRUE)
# Labour market
m3 <- lm(y ~ tightness + unemprate + private_empl_share + sme_empl_share, modelData,
             weight = GRP)
m3r <- coeftest(m3, vcov = vcovHAC, save = TRUE)
# Trade
m4 <- lm(y ~ imgrp + exsh + imsh, modelData,
             weight = GRP)
m4r <- coeftest(m4, vcov = vcovHAC, save = TRUE)
# Budget
m5 <- lm(y ~ defense + security + economy + social + debtgrp, modelData,
             weight = GRP)
m5r <- coeftest(m5, vcov = vcovHAC, save = TRUE)
# Table
ts <- officer::fp_tabs(
  officer::fp_tab(pos = .4, style = "decimal"),
  officer::fp_tab(pos = 1.2, style = "decimal")
)
tab <- huxreg("ВРП" = m1, "Неравенство" = m2, "Рынок труда" = m3, "Внешняя торговля" = m4, "Бюджет" = m5, number_format = 2, statistics = c("N" = "nobs", 
      "R^2" = "r.squared", "R^2 adj." = "adj.r.squared", "F statistic" = "statistic",
      "P value" = "p.value"), bold_signif = 0.1, stars = c(`*` = 0.1, `**` = 0.05, `***` = 0.01),
      coefs = c("Константа" = "(Intercept)"
                ,"Логарифм ВРП" = "log(GRP)",
                "Доля добычи в ВРП" = "extraction",
                "Доля обработки в ВРП" = "industry",
                "Доля строительства в ВРП" = "construction",
                "Децильный коэффициент" = "decile_coeff",
                "Уровень бедности" = "poverty",
                "Доля занятости в частном секторе" = "private_empl_share",
                "Доля занятости на МСП" = "sme_empl_share",
                "Напряжённость рынка труда" = "tightness",
                "Безработица" = "unemprate",
                "Импорт/ВРП" = "imgrp",
                "Отгрузка товаров из других регионов" = "imsh",
                "Отгрузка товаров в другие регионы" = "exsh",
                "Расходы на нацоборону" = "defense",
                "Расходы на нацбезопасность" = "security",
                "Социальные расходы" = "social",
                "Расходы на нацэкономику" = "economy",
                "Госдолг к ВРП" = "debtgrp"
                )) %>%
  set_align(., '.')
tab <- tab[-seq(3,39,2),]
tab %>%
  as_flextable() %>%
  add_footer_lines('Примечание: в качестве зависимой переменной используется средняя величина spill-out эффекта на горизонте 3 месяцев. Наблюдения в регрессии взвешены по региональному подушевому ВРП') %>%
  tabForm(cap = 'Факторы гетерогенности spill-out эффектов') %>%
  flextable::align(align = 'left', part = 'all') %>%
  prepend_chunks(j = 2:5, as_chunk("\t")) %>%
  tab_settings(j = 2:5, value = ts) 
```

```{r SpillInRegress, tab.id = "SpillInRegress"}
modelData <- tableregionspillY %>%
  select(OKATO, OKATO_id, y = SP0) %>%
  left_join(explanatory %>% select(-c(OKATO,sport,state,culture,utilities)))
# GRP and Structure
m1 <- lm(y ~ log(GRP) + extraction + industry + construction, modelData,
             weight = GRP)
m1r <- coeftest(m1, vcov = vcovHAC, save = TRUE)
# Liquidity constraints
m2 <- lm(y ~ decile_coeff + poverty, modelData,
             weight = GRP)
m2r <- coeftest(m2, vcov = vcovHAC, save = TRUE)
# Labour market
m3 <- lm(y ~ tightness + unemprate + private_empl_share + sme_empl_share, modelData,
             weight = GRP)
m3r <- coeftest(m3, vcov = vcovHAC, save = TRUE)
# Trade
m4 <- lm(y ~ imgrp + exsh + imsh, modelData,
             weight = GRP)
m4r <- coeftest(m4, vcov = vcovHAC, save = TRUE)
# Budget
m5 <- lm(y ~ defense + security + economy + social + debtgrp, modelData,
             weight = GRP)
m5r <- coeftest(m5, vcov = vcovHAC, save = TRUE)
# Table
ts <- officer::fp_tabs(
  officer::fp_tab(pos = .4, style = "decimal"),
  officer::fp_tab(pos = 1.2, style = "decimal")
)
tab <- huxreg("ВРП" = m1, "Неравенство" = m2, "Рынок труда" = m3, "Внешняя торговля" = m4, "Бюджет" = m5, number_format = 2, statistics = c("N" = "nobs", 
      "R^2" = "r.squared", "R^2 adj." = "adj.r.squared", "F statistic" = "statistic",
      "P value" = "p.value"), bold_signif = 0.1, stars = c(`*` = 0.1, `**` = 0.05, `***` = 0.01),
      coefs = c("Константа" = "(Intercept)"
                ,"Логарифм ВРП на душу" = "log(GRP)",
                "Доля добычи в ВРП" = "extraction",
                "Доля обработки в ВРП" = "industry",
                "Доля строительства в ВРП" = "construction",
                "Децильный коэффициент" = "decile_coeff",
                "Уровень бедности" = "poverty",
                "Доля занятости в частном секторе" = "private_empl_share",
                "Доля занятости на МСП" = "sme_empl_share",
                "Напряжённость рынка труда" = "tightness",
                "Безработица" = "unemprate",
                "Импорт/ВРП" = "imgrp",
                "Отгрузка товаров из других регионов" = "imsh",
                "Отгрузка товаров в другие регионы" = "exsh",
                "Расходы на нацоборону" = "defense",
                "Расходы на нацбезопасность" = "security",
                "Социальные расходы" = "social",
                "Расходы на нацэкономику" = "economy",
                "Госдолг к ВРП" = "debtgrp"
                )) %>%
  set_align(., '.')
tab <- tab[-seq(3,39,2),]
tab %>%
  as_flextable() %>%
  add_footer_lines('Примечание: в качестве зависимой переменной используется средняя величина spill-in эффекта на горизонте 3 месяцев. Наблюдения в регрессии взвешены по региональному подушевому ВРП') %>%
  tabForm(cap = 'Факторы гетерогенности spill-in эффектов') %>%
  flextable::align(align = 'left', part = 'all') %>%
  prepend_chunks(j = 2:5, as_chunk("\t")) %>%
  tab_settings(j = 2:5, value = ts)
```


`r figNote('расчёт автора на основе данных Росстата. При расчёте коэффициента Джини регионы взвешиваются по численности населения.')`

```{r}
knitr::knit_hooks$set(document = function(x){
  gsub('w:val="Table Caption"/><w:jc w:val="center"/>','w:val="Table Caption"/><w:jc w:val="left"/>',x,fixed=TRUE)
})
```